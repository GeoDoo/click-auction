<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="description" content="Join the Click Auction game - Tap to bid!">
  <title>Play - Click Auction</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/common.css">
  <link rel="stylesheet" href="/css/play.css">
</head>
<body>
  <!-- Loading Screen -->
  <div class="loading-screen" id="loadingScreen" role="status" aria-live="polite" aria-label="Loading">
    <div class="loading-content">
      <div class="loading-visual">
        <video class="loading-video" id="loadingVideo" autoplay muted loop playsinline>
          <source src="/videos/Turtle_With_Wheels_Animation.mp4" type="video/mp4">
        </video>
      </div>
      <div class="loading-text">
        <span class="loading-dots">Connecting</span>
      </div>
    </div>
  </div>

  <div class="bg" id="bg" aria-hidden="true"></div>

  <!-- Join Screen -->
  <main class="join-screen" id="joinScreen" role="main">
    <h1 class="logo">CLICK AUCTION</h1>
    <p class="subtitle">Join as a DSP</p>
    
    <div class="rules-quick" role="list" aria-label="Quick rules">
      <div class="rule-item" role="listitem">â±ï¸ <strong>Timed</strong> auction</div>
      <div class="rule-item" role="listitem">ğŸ‘† Tap = <strong>1 bid</strong></div>
      <div class="rule-item" role="listitem">ğŸ† Most bids <strong>wins!</strong></div>
    </div>
    
    <form class="join-form" id="joinForm" onsubmit="joinGame(); return false;">
      <div class="input-group">
        <label for="playerName">Your DSP Name</label>
        <input type="text" id="playerName" placeholder="e.g., MegaBidder9000" maxlength="20" autocomplete="off" required aria-required="true">
      </div>
      <div class="input-group">
        <label for="adContent">Your Winning Ad Message (shown if you win!)</label>
        <input type="text" id="adContent" placeholder="e.g., Best DSP in town! ğŸš€" maxlength="60" autocomplete="off" required aria-required="true">
        <small style="color: #666; font-size: 0.85rem; margin-top: 0.5rem; display: block;" id="adContentHint">This becomes a generated ad image on the big screen!</small>
      </div>
      <button type="submit" class="btn-join">Enter the Arena</button>
    </form>
  </main>

  <!-- Game Screen -->
  <div class="game-screen" id="gameScreen" role="main" aria-label="Game area">
    <header class="game-header">
      <div class="player-info">
        <div class="player-color-dot" id="playerColorDot" aria-hidden="true"></div>
        <span class="player-name-display" id="playerNameDisplay" aria-label="Your name"></span>
      </div>
      <div class="header-right">
        <button class="sound-toggle" id="soundToggle" onclick="toggleSound()" aria-label="Toggle sound" aria-pressed="true">ğŸ”Š</button>
        <div class="game-status-badge status-waiting" id="gameStatusBadge" role="status" aria-live="polite">Waiting</div>
      </div>
    </header>

    <div class="game-main">
      <section class="click-section" aria-label="Bidding area">
        <div class="click-counter" id="clickCounter" aria-live="polite" aria-atomic="true">0</div>
        <div class="click-label" id="clickLabel">Your Bids</div>
        <button class="bid-button waiting" id="bidButton" disabled aria-describedby="clickLabel" aria-label="Tap to bid">
          Wait...
        </button>
      </section>
    </div>
  </div>

  <!-- Stage Transition Overlay -->
  <div class="stage-overlay" id="stageOverlay" role="alert" aria-live="assertive">
    <div class="stage-icon" id="stageIcon">âœ…</div>
    <div class="stage-title" id="stageTitle">CLICK AUCTION COMPLETE!</div>
    <div class="stage-score" id="stageScore">Your taps: 0</div>
    <div class="stage-next" id="stageNext">Get ready for FASTEST FINGER...</div>
  </div>

  <!-- Results Overlay -->
  <div class="winner-overlay" id="winnerOverlay" role="dialog" aria-modal="true" aria-labelledby="winnerTitle">
    <div class="winner-trophy" id="winnerTrophy" aria-hidden="true">ğŸ†</div>
    <h2 class="winner-title" id="winnerTitle">Winner!</h2>
    <div class="winner-name-big" id="winnerNameBig"></div>
    <div class="winner-clicks-big" id="winnerClicksBig"></div>
    <div class="your-result" id="yourResult">
      <div class="your-result-label" id="yourResultLabel">Your Score</div>
      <div class="score-breakdown" id="scoreBreakdown"></div>
      <div class="your-result-value" id="yourResultValue" aria-live="polite">0 points</div>
      <div class="your-rank" id="yourRank" style="margin-top: 0.5rem; font-size: 1.2rem; color: #888;"></div>
    </div>
  </div>

  <!-- Error Overlay -->
  <div class="error-overlay" id="errorOverlay" role="alertdialog" aria-modal="true" aria-labelledby="errorText">
    <div class="error-text" id="errorText">An error occurred</div>
  </div>

  <script type="module" src="/js/play.js"></script>
</body>
</html>

